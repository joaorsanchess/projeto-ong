document.addEventListener("DOMContentLoaded", function () {
  let e = document.getElementById("formCadastro"),
    t = document.querySelector(".menu-hamburguer"),
    a = document.getElementById("navegacaoPrincipal");
  if (
    (t &&
      a &&
      (t.addEventListener("click", function () {
        a.classList.toggle("menu-aberto"), t.classList.toggle("menu-aberto");
        let e = a.classList.contains("menu-aberto");
        if ((t.setAttribute("aria-expanded", e), e)) {
          let n = a.querySelector("a");
          n && n.focus();
        }
      }),
      document.addEventListener("click", function (e) {
        let n = a.classList.contains("menu-aberto"),
          i = a.contains(e.target),
          o = t.contains(e.target);
        !n ||
          i ||
          o ||
          (a.classList.remove("menu-aberto"),
          t.classList.remove("menu-aberto"),
          t.setAttribute("aria-expanded", "false"));
      }),
      document.addEventListener("keydown", function (e) {
        "Escape" === e.key &&
          a.classList.contains("menu-aberto") &&
          (a.classList.remove("menu-aberto"),
          t.classList.remove("menu-aberto"),
          t.setAttribute("aria-expanded", "false"),
          t.focus());
      })),
    e)
  ) {
    let n = document.getElementById("nome"),
      i = document.getElementById("email"),
      o = document.getElementById("cpf"),
      r = document.getElementById("telefone"),
      s = document.getElementById("cep"),
      l = document.getElementById("nascimento"),
      d = document.getElementById("endereco"),
      u = document.getElementById("cidade"),
      c = document.getElementById("estado");
    function m(e, t) {
      let a = e.nextElementSibling;
      (a && a.classList.contains("mensagem-erro")) ||
        ((a = document.createElement("span")).classList.add("mensagem-erro"),
        a.setAttribute("aria-live", "polite"),
        e.parentNode.insertBefore(a, e.nextSibling)),
        (a.textContent = t),
        e.setAttribute("aria-invalid", "true"),
        e.classList.add("invalido"),
        e.classList.remove("valido");
    }
    function v(e) {
      let t = e.nextElementSibling;
      t && t.classList.contains("mensagem-erro") && (t.textContent = ""),
        e.setAttribute("aria-invalid", "false"),
        e.classList.remove("invalido"),
        e.classList.add("valido");
    }
    n &&
      n.addEventListener("input", function () {
        (n.value = n.value.replace(/[0-9]/g, "")),
          n.value.trim().split(" ").length < 2 && "" !== n.value.trim()
            ? m(n, "Digite nome e sobrenome.")
            : v(n);
      }),
      i &&
        (i.addEventListener("blur", function () {
          "" === i.value.trim() || /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.value)
            ? v(i)
            : m(i, "Formato de e-mail inv\xe1lido.");
        }),
        i.addEventListener("input", function () {
          v(i);
        })),
      o &&
        o.addEventListener("input", (e) => {
          var t;
          (e.target.value = (t = (t = (t = (t = (t = e.target.value).replace(
            /\D/g,
            ""
          )).replace(/(\d{3})(\d)/, "$1.$2")).replace(
            /(\d{3})(\d)/,
            "$1.$2"
          )).replace(/(\d{3})(\d{1,2})$/, "$1-$2")).substring(0, 14)),
            v(e.target);
        }),
      r &&
        r.addEventListener("input", (e) => {
          var t;
          (e.target.value = (t = (t = (t = (t = e.target.value).replace(
            /\D/g,
            ""
          )).replace(/^(\d{2})(\d)/g, "($1) $2")).replace(
            /(\d{5})(\d)/,
            "$1-$2"
          )).substring(0, 15)),
            v(e.target);
        }),
      s &&
        s.addEventListener("input", (e) => {
          var t;
          (e.target.value = (t = (t = (t = e.target.value).replace(
            /\D/g,
            ""
          )).replace(/(\d{5})(\d)/, "$1-$2")).substring(0, 9)),
            v(e.target);
        }),
      [l, d, u, c].forEach((e) => {
        e && e.addEventListener("input", () => v(e));
      }),
      e.addEventListener("submit", function (t) {
        t.preventDefault(), console.log("Tentativa de envio interceptada!");
        let a = !0;
        e.querySelectorAll(".campo-entrada").forEach(v),
          (!n || n.value.trim().split(" ").length < 2) &&
            (m(n, "Por favor, insira seu nome completo."),
            a && n.focus(),
            (a = !1)),
          (i && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.value)) ||
            (m(i, "Formato de e-mail inv\xe1lido."), a && i.focus(), (a = !1)),
          (o && 14 === o.value.length) ||
            (m(o, "CPF inv\xe1lido. Use o formato 000.000.000-00."),
            a && o.focus(),
            (a = !1)),
          (r && 15 === r.value.length) ||
            (m(r, "Telefone inv\xe1lido. Use o formato (00) 00000-0000."),
            a && r.focus(),
            (a = !1)),
          (l && "" !== l.value) ||
            (m(l, "Data de nascimento \xe9 obrigat\xf3ria."),
            a && l.focus(),
            (a = !1)),
          (s && 9 === s.value.length) ||
            (m(s, "CEP inv\xe1lido. Use o formato 00000-000."),
            a && s.focus(),
            (a = !1)),
          (d && "" !== d.value.trim()) ||
            (m(d, "Endere\xe7o \xe9 obrigat\xf3rio."),
            a && d.focus(),
            (a = !1)),
          (u && "" !== u.value.trim()) ||
            (m(u, "Cidade \xe9 obrigat\xf3ria."), a && u.focus(), (a = !1)),
          (c && "" !== c.value.trim()) ||
            (m(c, "Estado \xe9 obrigat\xf3rio."), a && c.focus(), (a = !1)),
          a
            ? (console.log(
                "Formul\xe1rio v\xe1lido! Enviando dados (simulado)..."
              ),
              alert("Cadastro enviado com sucesso! (Simulado)"),
              e.reset(),
              e.querySelectorAll(".campo-entrada").forEach((e) => {
                e.classList.remove("valido", "invalido");
              }))
            : console.log("Formul\xe1rio inv\xe1lido.");
      });
  }
});
